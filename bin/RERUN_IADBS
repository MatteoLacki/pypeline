# from vodkas.cli import make_cli
# from vodkas.iadbs import iadbs

# make_cli(iadbs, custom_delete=[])

import argparse
from docstr2argparse import parse_arguments

import logging
from pathlib import Path
from pprint import pprint

from vodkas import iadbs
from vodkas.fastas import get_fastas
from vodkas.logging import get_logger


parser = argparse.ArgumentParser(description='Rerun search with iaDBs.')

parser.add_argument('raw_folders',
                    type=Path,
                    help='Path(s) to the raw_folder(s) to be analysed.',
                    nargs="+")
args = parser.parse_args().__dict__

symphony_local = Path(r"C:/SYMPHONY_VODKAS")
logging.basicConfig(filename=symphony_local/"iadbs.log",
                    format='RERUN_IADBS %(asctime)s:%(name)s:%(levelname)s:%(message)s:',
                    level=logging.INFO)
logger = get_logger(__name__)
fastas = get_fastas(input("Organism/Path to Fastas:"))

for f in args['raw_folders']:
	try:
		input = f/f"{f.stem}_Pep3D_Spectrum.xml"
		outfile, _ = iadbs(input, f, fastas)
	except Exception as e:
		print(f)
		print(e)
		print()
